import{j as e,a as _,r as t,c as V}from"./app-CdaVaMdr.js";import{A as M}from"./app-layout-DAxnsUqW.js";import{P as B}from"./PaginationInertia-B5mxwwfr.js";import{B as x}from"./button-DX4rUyCX.js";import{a as U,C as L}from"./chevron-up-DJf8C4B9.js";import{I as p}from"./input-B_XBTnPd.js";import{S as w,a as z,b as T,c as E,d as f}from"./select-DHnzWxo2.js";import{C as q}from"./ConfirmModal-Bab1ahjk.js";import{T as F}from"./Toast-Dk4FGC3x.js";/* empty css            */import"./Edit-DNxWt32P.js";import"./index-cFw2X6NW.js";import"./createLucideIcon-CJZ60ZCH.js";import"./index-TJCVTMuW.js";import"./index-C-ZSrLmy.js";import"./index-BTX1XJQz.js";import"./app-logo-icon-DhLlcZEl.js";import"./index-DQ_cOJ-6.js";const G=({clientes:a,filters:r,onEdit:m,onDelete:u,onDetail:c})=>{const h=s=>{let n;r.sort===s?n=r.direction==="asc"?"desc":"asc":n="asc",_.get("/clientes",{sort:s,direction:n},{preserveState:!0})},j=s=>r.sort!==s?null:r.direction==="asc"?e.jsx(U,{className:"inline-block w-4 h-4 ml-1"}):e.jsx(L,{className:"inline-block w-4 h-4 ml-1"});return e.jsxs("div",{className:"overflow-x-auto bg-default rounded-lg shadow",children:[e.jsxs("table",{className:"min-w-full text-sm text-left border",children:[e.jsx("thead",{className:"bg-default",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"px-4 py-2 border cursor-pointer",onClick:()=>h("nombre_razon_social"),children:["Nombre/Razón Social ",j("nombre_razon_social")]}),e.jsx("th",{className:"px-4 py-2 border",children:"Propietario"}),e.jsx("th",{className:"px-4 py-2 border",children:"Referencias"}),e.jsx("th",{className:"px-4 py-2 border",children:"Acciones"})]})}),e.jsx("tbody",{children:a?.data?.length?a.data.map(s=>e.jsxs("tr",{className:"border-t hover:bg-neutral-100 dark:hover:bg-neutral-800 cursor-pointer",onClick:()=>c(s),children:[e.jsx("td",{className:"px-4 py-2",children:s.nombre_razon_social}),e.jsx("td",{className:"px-4 py-2",children:s.propietario}),e.jsxs("td",{className:"px-4 py-2",children:[[s.email,s.telefono,s.direccion].filter(Boolean).join(" | "),e.jsx("p",{children:s.ubicacion&&e.jsx("a",{href:s.ubicacion,target:"_blank",rel:"noopener noreferrer",onClick:n=>n.stopPropagation(),className:"text-blue-500 underline",children:"Ver en mapa"})})]}),e.jsxs("td",{className:"px-4 text-center",children:[e.jsx(x,{onClick:n=>{n.stopPropagation(),m(s)},variant:"warning",className:"mb-1 w-20",children:"Editar"}),e.jsx(x,{onClick:n=>{n.stopPropagation(),u(s)},variant:"destructive",className:"mb-1 w-20",children:"Eliminar"})]})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-2 text-center text-gray-500",children:"No hay clientes disponibles"})})})]}),e.jsx(B,{links:a?.links??[]})]})},H=({onClose:a,onSaved:r})=>{const[m,u]=t.useState("CI"),[c,h]=t.useState("NATURAL"),[j,s]=t.useState(""),[n,v]=t.useState(""),[b,g]=t.useState(""),[N,S]=t.useState(""),[C,y]=t.useState(""),[i,D]=t.useState(""),[I,R]=t.useState(""),[k,P]=t.useState("activo"),[o,d]=t.useState(""),A=l=>{l.preventDefault(),_.post("/clientes",{tipo_documento:m,tipo:c,numero_documento:j,nombre_razon_social:n,direccion:N,propietario:b,ubicacion:C,telefono:i,email:I,estado:k,notas:o},{onSuccess:()=>{a(),r(`Cliente '${n}' creado correctamente ✅`)},onError:$=>{console.error($),alert("Error al crear el cliente. Ver consola para más detalles.")}})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"p-6 rounded w-96 bg-neutral-100 dark:bg-neutral-800",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Nuevo Cliente"}),e.jsxs("form",{onSubmit:A,className:"space-y-2",children:[e.jsx("input",{type:"hidden",name:"tipo_documento",value:m}),e.jsx(p,{type:"text",placeholder:"Nombre / Razón Social",value:n,onChange:l=>v(l.target.value),required:!0}),e.jsx(p,{type:"text",placeholder:"Propietario",value:b,onChange:l=>g(l.target.value)}),e.jsx(p,{type:"text",placeholder:"Dirección",value:N,onChange:l=>S(l.target.value)}),e.jsx(p,{type:"text",placeholder:"Ubicación",value:C,onChange:l=>y(l.target.value)}),e.jsx(p,{type:"text",placeholder:"Teléfono",value:i,onChange:l=>D(l.target.value)}),e.jsxs(w,{value:k,onValueChange:l=>P(l),children:[e.jsx(z,{children:e.jsx(T,{placeholder:"Estado"})}),e.jsxs(E,{children:[e.jsx(f,{value:"activo",children:"Activo"}),e.jsx(f,{value:"inactivo",children:"Inactivo"})]})]}),e.jsx("textarea",{placeholder:"Notas",className:"border p-2 w-full",value:o,onChange:l=>d(l.target.value)}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-2",children:[e.jsx(x,{type:"button",onClick:a,variant:"secondary",children:"Cancelar"}),e.jsx(x,{type:"submit",variant:"default",children:"Crear"})]})]})]})})},J=({cliente:a,onClose:r,onSaved:m})=>{const[u,c]=t.useState(a.numero_documento),[h,j]=t.useState(a.nombre_razon_social),[s,n]=t.useState(a.direccion),[v,b]=t.useState(a.telefono),[g,N]=t.useState(a.email),[S,C]=t.useState(a.notas||""),[y,i]=t.useState(a.tipo_documento||"CI"),[D,I]=t.useState(a.tipo||"activo"),[R,k]=t.useState(a.estado||"activo"),P=o=>{o.preventDefault();const d=new FormData;d.append("numero_documento",u),d.append("nombre_razon_social",h),d.append("direccion",s),d.append("telefono",v),d.append("email",g),d.append("notas",S),d.append("tipo_documento",y),d.append("tipo",D),d.append("estado",R),d.append("_method","PUT"),_.post(`/clientes/${a.id}`,d,{onSuccess:()=>{m(`Cliente '${h}' actualizado correctamente ✅`),r()}})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"p-6 rounded w-96 bg-neutral-100 dark:bg-neutral-800",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Editar Cliente"}),e.jsxs("form",{onSubmit:P,className:"space-y-2",children:[e.jsx(p,{type:"text",placeholder:"Número de documento",value:u,onChange:o=>c(o.target.value),required:!0}),e.jsxs(w,{value:y,onValueChange:o=>i(o),children:[e.jsx(z,{children:e.jsx(T,{placeholder:"Tipo de documento"})}),e.jsxs(E,{children:[e.jsx(f,{value:"CI",children:"CI"}),e.jsx(f,{value:"NIT",children:"NIT"})]})]}),e.jsx(p,{type:"text",placeholder:"Nombre o Razón Social",value:h,onChange:o=>j(o.target.value),required:!0}),e.jsx(p,{type:"text",placeholder:"Dirección",value:s,onChange:o=>n(o.target.value)}),e.jsx(p,{type:"text",placeholder:"Teléfono",value:v,onChange:o=>b(o.target.value)}),e.jsx(p,{type:"email",placeholder:"Email",value:g,onChange:o=>N(o.target.value)}),e.jsx("textarea",{placeholder:"Notas",className:"border p-2 w-full",value:S,onChange:o=>C(o.target.value)}),e.jsxs(w,{value:D,onValueChange:o=>I(o),children:[e.jsx(z,{children:e.jsx(T,{placeholder:"Tipo"})}),e.jsxs(E,{children:[e.jsx(f,{value:"activo",children:"Activo"}),e.jsx(f,{value:"inactivo",children:"Inactivo"})]})]}),e.jsxs(w,{value:R,onValueChange:o=>k(o),children:[e.jsx(z,{children:e.jsx(T,{placeholder:"Estado"})}),e.jsxs(E,{children:[e.jsx(f,{value:"activo",children:"Activo"}),e.jsx(f,{value:"inactivo",children:"Inactivo"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-2",children:[e.jsx(x,{onClick:r,variant:"secondary",children:"Cancelar"}),e.jsx(x,{type:"submit",variant:"default",children:"Guardar"})]})]})]})})},K=({cliente:a,onClose:r})=>a?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[1000]",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6 relative shadow-lg",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Detalle del Cliente"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:"Información completa del cliente seleccionado."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"ID:"})," ",a.id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Nombre / Razón Social:"})," ",a.nombre_razon_social]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Documento:"})," ",`${a.tipo??""} ${a.tipo_documento??""} ${a.numero_documento??""}`]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",a.email||"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Teléfono:"})," ",a.telefono||"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Dirección:"})," ",a.direccion||"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Creado:"})," ",a.created_at?new Date(a.created_at).toLocaleString():"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Actualizado:"})," ",a.updated_at?new Date(a.updated_at).toLocaleString():"—"]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(x,{variant:"secondary",onClick:r,children:"Cerrar"})})]})}):null,O=({initialSearch:a=""})=>{const[r,m]=t.useState(a),u=c=>{c.preventDefault(),_.get("/clientes",{search:r},{preserveState:!0})};return e.jsxs("form",{onSubmit:u,className:"mb-4 flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Buscar cliente...",className:"border p-2 flex-1",value:r,onChange:c=>m(c.target.value)}),e.jsx(x,{type:"submit",variant:"default",className:"px-4 py-2",children:"Buscar"})]})},pe=({clientes:a,filters:r})=>{const{flash:m}=V().props,[u,c]=t.useState(m?.success||null),[h,j]=t.useState(!1),[s,n]=t.useState(null),[v,b]=t.useState(null),[g,N]=t.useState(null),S=i=>{_.delete(`/clientes/${i.id}`,{onSuccess:()=>c(`Cliente '${i.nombre_razon_social}' eliminado correctamente.`)}),b(null)},C=i=>{c(i)},y=[{title:"Clientes",href:"/clientes"}];return e.jsx(M,{breadcrumbs:y,children:e.jsxs("div",{className:"p-4",children:[e.jsx(x,{onClick:()=>j(!0),variant:"default",className:"mb-4",children:"Nuevo Cliente"}),e.jsx(O,{initialSearch:r.search}),e.jsx(G,{clientes:a,filters:r,onEdit:n,onDelete:b,onDetail:N}),h&&e.jsx(H,{onClose:()=>j(!1),onSaved:i=>C(i)}),s&&e.jsx(J,{cliente:s,onClose:()=>n(null),onSaved:i=>C(i)}),g&&e.jsx(K,{cliente:g,onClose:()=>N(null)}),v&&e.jsx(q,{text:v.nombre_razon_social,onConfirm:()=>S(v),onClose:()=>b(null)}),u&&e.jsx(F,{message:u,onClose:()=>c(null)})]})})};export{pe as default};
