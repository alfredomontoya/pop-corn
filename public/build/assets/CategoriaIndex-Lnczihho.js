import{j as e,a as v,r as l,b as C,c as L}from"./app-Dirc8Dxq.js";import{A as F}from"./app-layout-73mEwPg6.js";import{P}from"./PaginationInertia-BYXrAihr.js";import{B as u}from"./button-DWW02SMM.js";import{c as T}from"./createLucideIcon-CDbX26ET.js";import{T as M}from"./trash-CPyr9joK.js";import{a as z,C as _}from"./chevron-up-ABHvKFAz.js";import{I as S}from"./input-C3HqiSkc.js";import{T as D}from"./TextArea-BsxrIFEh.js";import{L as N}from"./label-XP6f1jzb.js";import{Z as R}from"./ZoomImageModal-BE7Aafvs.js";import{C as U}from"./ConfirmModal-Dwc1C2Ps.js";import{T as A}from"./Toast-D8UoK7H9.js";/* empty css            */import"./Edit-HdEDvN3P.js";import"./index-DiaJ5on7.js";import"./index-DpVR0uHb.js";import"./index-DQr8XXov.js";import"./index-CoZuJPrS.js";import"./app-logo-icon-CzPGUPWN.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]],$=T("PenLine",O),B=({categorias:s,filters:i,onEdit:m,onDelete:c,onDetail:n})=>{const d=a=>{const p=i.sort===a&&i.direction==="asc"?"desc":"asc";v.get("/categorias",{sort:a,direction:p},{preserveState:!0})},x=a=>i.sort!==a?null:i.direction==="asc"?e.jsx(z,{className:"inline-block w-4 h-4 ml-1"}):e.jsx(_,{className:"inline-block w-4 h-4 ml-1"});return e.jsxs("div",{className:"overflow-x-auto bg-default rounded-lg shadow",children:[e.jsxs("table",{className:"min-w-full text-sm text-left border",children:[e.jsx("thead",{className:"bg-default",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"px-4 py-2 border cursor-pointer",onClick:()=>d("id"),children:["ID ",x("id")]}),e.jsx("th",{className:"px-4 py-2 border",children:"Imagen"}),e.jsxs("th",{className:"px-4 py-2 border cursor-pointer",onClick:()=>d("nombre"),children:["Nombre ",x("nombre")]}),e.jsxs("th",{className:"px-4 py-2 border cursor-pointer",onClick:()=>d("descripcion"),children:["Descripción ",x("descripcion")]}),e.jsx("th",{className:"px-4 py-2 border",children:"Acciones"})]})}),e.jsx("tbody",{children:s?.data?.length?s.data.map(a=>e.jsxs("tr",{className:"border-t hover:bg-neutral-100 dark:hover:bg-neutral-800 cursor-pointer",onClick:()=>n(a),children:[e.jsx("td",{className:"px-4 py-2",children:a.id}),e.jsx("td",{className:"px-4 py-2",children:a.imagen?e.jsx("img",{src:a.imagen?.startsWith("http")?a.imagen:`/storage/${a.imagen}`,alt:a.nombre??"",className:"w-12 h-12 object-cover rounded",loading:"lazy"}):e.jsx("img",{src:"/images/default-category.png",alt:a.nombre??"",className:"w-12 h-12 object-cover rounded",loading:"lazy"})}),e.jsx("td",{className:"px-4 py-2",children:a.nombre}),e.jsx("td",{className:"px-4 py-2",children:a.descripcion}),e.jsxs("td",{className:"px-4 py-2 space-x-2 text-center",children:[e.jsx(u,{onClick:p=>{p.stopPropagation(),m(a)},variant:"warning",className:"px-2 py-1",children:e.jsx($,{})}),e.jsx(u,{onClick:p=>{p.stopPropagation(),c(a)},variant:"destructive",className:"px-2 py-1",children:e.jsx(M,{})})]})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-2 text-center text-gray-500",children:"No hay categorías disponibles"})})})]}),e.jsx(P,{links:s?.links??[]})]})},Z=({onClose:s,onSaved:i})=>{const[m,c]=l.useState({nombre:"",descripcion:"",imagen:null}),[n,d]=l.useState(null),[x,a]=l.useState({}),p=h=>{const{id:t,value:r}=h.target;c(o=>({...o,[t]:r}))},b=h=>{const t=h.target.files?.[0]||null;c(r=>({...r,imagen:t})),d(t?URL.createObjectURL(t):null)},j=async h=>{h.preventDefault();const t=new FormData;Object.entries(m).forEach(([r,o])=>{o!==null&&t.append(r,o)});try{const{data:r}=await C.post("/categorias",t,{headers:{"Content-Type":"multipart/form-data"}});r.success&&(a({}),i(r.message),s())}catch(r){console.error("Errores de validación:",r.response?.data?.errors),a(r.response?.data?.errors||{})}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"p-6 rounded w-96 bg-primary-foreground shadow-lg",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Nueva Categoría"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"nombre",children:"Nombre"}),e.jsx(S,{id:"nombre",value:m.nombre,onChange:p,placeholder:"Nombre"}),x.nombre&&e.jsx("p",{className:"text-red-500 text-sm",children:x.nombre[0]})]}),e.jsx(D,{label:"Descripción",value:m.descripcion,onChange:h=>c(t=>({...t,descripcion:h})),placeholder:"Descripción",error:x.descripcion?.[0]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"imagen",children:"Imagen"}),e.jsx("input",{id:"imagen",type:"file",accept:"image/*",onChange:b}),n&&e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx("img",{src:n,alt:"Preview",className:"w-32 h-32 object-cover rounded border"})})]}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(u,{type:"button",onClick:s,variant:"secondary",children:"Cancelar"}),e.jsx(u,{type:"submit",children:"Crear"})]})]})]})})},W=({categoria:s,onClose:i,onSaved:m})=>{const[c,n]=l.useState({nombre:s.nombre||"",descripcion:s.descripcion||"",imagen:null}),[d,x]=l.useState(s.imagen?s.imagen.startsWith("http")?s.imagen:`/storage/${s.imagen}`:null),[a,p]=l.useState({}),b=t=>{const{id:r,value:o}=t.target;n(f=>({...f,[r]:o}))},j=t=>{const r=t.target.files?.[0]||null;n(o=>({...o,imagen:r})),x(r?URL.createObjectURL(r):d)},h=async t=>{t.preventDefault();const r=new FormData;r.append("_method","PUT"),Object.entries(c).forEach(([o,f])=>{f!==null&&r.append(o,f)});try{const{data:o}=await C.post(`/categorias/${s.id}`,r,{headers:{"Content-Type":"multipart/form-data"}});o.success&&(p({}),m(o.message),i())}catch(o){console.error("Errores de validación:",o.response?.data?.errors),p(o.response?.data?.errors||{})}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"p-6 rounded w-96 bg-primary-foreground shadow-lg",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Editar Categoría"}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"nombre",children:"Nombre"}),e.jsx(S,{id:"nombre",value:c.nombre,onChange:b,placeholder:"Nombre"}),a.nombre&&e.jsx("p",{className:"text-red-500 text-sm",children:a.nombre[0]})]}),e.jsx(D,{label:"Descripción",value:c.descripcion,onChange:t=>n(r=>({...r,descripcion:t})),placeholder:"Descripción",error:a.descripcion?.[0]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"imagen",children:"Imagen"}),e.jsx("input",{id:"imagen",type:"file",accept:"image/*",onChange:j}),a.imagen&&e.jsx("p",{className:"text-red-500 text-sm",children:a.imagen[0]})]}),d&&e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:d,alt:"Preview",className:"w-32 h-32 object-cover rounded border mt-2"})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx(u,{type:"button",onClick:i,variant:"secondary",children:"Cancelar"}),e.jsx(u,{type:"submit",children:"Guardar"})]})]})]})})},G=({categoria:s,onClose:i})=>{const[m,c]=l.useState(!1);if(!s)return null;const n=s.imagen?.startsWith("http")?s.imagen:`/storage/${s.imagen??"images/default-category.png"}`;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[1000]",children:e.jsxs("div",{className:"bg-primary-foreground rounded-lg max-w-md w-full p-6 relative shadow-lg",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Detalle de Categoría"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:"Información completa de la categoría seleccionada."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("img",{src:n,alt:s.nombre,className:"w-40 h-40 object-cover rounded cursor-pointer hover:opacity-90 transition",onClick:()=>c(!0)})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"ID:"})," ",s.id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Nombre:"})," ",s.nombre]}),s.descripcion&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Descripción:"})," ",s.descripcion]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Creado:"})," ",s.created_at?new Date(s.created_at).toLocaleString():"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Actualizado:"})," ",s.updated_at?new Date(s.updated_at).toLocaleString():"—"]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(u,{variant:"secondary",onClick:i,children:"Cerrar"})})]})}),e.jsx(R,{open:m,onOpenChange:c,src:n,alt:s.nombre})]})},q=({initialSearch:s=""})=>{const[i,m]=l.useState(s),c=n=>{n.preventDefault(),v.get("/categorias",{search:i},{preserveState:!0})};return e.jsxs("form",{onSubmit:c,className:"mb-4 flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Buscar categoría...",className:"border p-2 flex-1",value:i,onChange:n=>m(n.target.value)}),e.jsx(u,{type:"submit",variant:"default",className:"px-4 py-2",children:"Buscar"})]})},he=({categorias:s,filters:i})=>{const{flash:m,categorias:c}=L().props,[n,d]=l.useState(m?.success||null),[x,a]=l.useState(!1),[p,b]=l.useState(null),[j,h]=l.useState(null),[t,r]=l.useState(null),[o,f]=l.useState(s);l.useEffect(()=>{f(c)},[c]);const k=async g=>{try{const{data:y}=await C.delete(`/categorias/${g.id}`);v.reload({only:["categorias"]}),d(y.message)}catch(y){const{response:E}=await y;d(E.data.message)}h(null)},w=g=>{d(g),v.reload({only:["categorias"]})},I=[{title:"Categorias",href:"/categorias"}];return e.jsx(F,{breadcrumbs:I,children:e.jsxs("div",{className:"p-4",children:[e.jsx(u,{onClick:()=>a(!0),variant:"default",className:"mb-4",children:"Nueva Categoría"}),e.jsx(q,{initialSearch:i.search}),e.jsx(B,{categorias:o,filters:i,onEdit:b,onDelete:h,onDetail:r}),x&&e.jsx(Z,{onClose:()=>a(!1),onSaved:g=>w(g)}),p&&e.jsx(W,{categoria:p,onClose:()=>b(null),onSaved:g=>w(g)}),t&&e.jsx(G,{categoria:t,onClose:()=>r(null)}),j&&e.jsx(U,{text:j.nombre??"",onConfirm:()=>k(j),onClose:()=>h(null)}),n&&e.jsx(A,{message:n,onClose:()=>d(null)})]})})};export{he as default};
