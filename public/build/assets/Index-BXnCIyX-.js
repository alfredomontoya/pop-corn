import{j as e,a as D,r as a,c as M}from"./app-CZ5wKpKF.js";import{A as U}from"./app-layout-W9ns13d5.js";import{B as x}from"./button-DEkS-519.js";import{a as V,C as q}from"./chevron-up-DcoQv5O1.js";import{I as p}from"./input-BPblLnNC.js";import{L as k}from"./label-BiHx0aQO.js";import{S as E,a as I,b as P,c as R,d as y}from"./select-p9GSZOg_.js";import{C as B}from"./ConfirmModal-CSgCtV5H.js";import{T as F}from"./Toast-D1oxEM4c.js";import{P as G}from"./PaginationInertia-CWxlUDtd.js";/* empty css            */import"./Edit-Cdu2FDnW.js";import"./index-BDmOzyiv.js";import"./createLucideIcon-CSAcrkPz.js";import"./index-B-1RjBMx.js";import"./index-BTsKYuKu.js";import"./index-jxqWOHrT.js";import"./app-logo-icon-B8Qs5zSS.js";import"./index-Ianfmymq.js";const H=({clientes:t,filters:r,onEdit:m,onDelete:u,onDetail:c})=>{const h=s=>{let n;r.sort===s?n=r.direction==="asc"?"desc":"asc":n="asc",D.get("/clientes",{sort:s,direction:n},{preserveState:!0})},j=s=>r.sort!==s?null:r.direction==="asc"?e.jsx(V,{className:"inline-block w-4 h-4 ml-1"}):e.jsx(q,{className:"inline-block w-4 h-4 ml-1"});return e.jsx("div",{className:"overflow-x-auto bg-default rounded-lg shadow",children:e.jsxs("table",{className:"min-w-full text-sm text-left border",children:[e.jsx("thead",{className:"bg-default",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"px-4 py-2 border cursor-pointer",onClick:()=>h("nombre_razon_social"),children:["Nombre/Razón Social ",j("nombre_razon_social")]}),e.jsx("th",{className:"px-4 py-2 border",children:"Propietario"}),e.jsx("th",{className:"px-4 py-2 border",children:"Teléfono"}),e.jsx("th",{className:"px-4 py-2 border",children:"Dirección"}),e.jsx("th",{className:"px-4 py-2 border",children:"Acciones"})]})}),e.jsx("tbody",{children:t?.data?.length?t.data.map(s=>e.jsxs("tr",{className:"border-t hover:bg-neutral-100 dark:hover:bg-neutral-800 cursor-pointer",onClick:()=>c(s),children:[e.jsx("td",{className:"px-4 py-2",children:s.nombre_razon_social}),e.jsx("td",{className:"px-4 py-2",children:s.propietario}),e.jsx("td",{className:"px-4 py-2",children:s.telefono}),e.jsxs("td",{children:[s.direccion," ",e.jsx("span",{children:s.ubicacion&&e.jsx(x,{onClick:n=>{n.stopPropagation(),window.open(`https://www.google.com/maps?q=${s.ubicacion}`,"_blank","noopener,noreferrer")},rel:"noopener noreferrer",children:"Ver en mapa"})})]}),e.jsxs("td",{className:"px-4 text-center",children:[e.jsx(x,{onClick:n=>{n.stopPropagation(),m(s)},variant:"warning",className:"my-1 w-20",children:"Editar"}),e.jsx(x,{onClick:n=>{n.stopPropagation(),u(s)},variant:"destructive",className:"my-1 w-20",children:"Eliminar"})]})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-2 text-center text-gray-500",children:"No hay clientes disponibles"})})})]})})},J=({onClose:t,onSaved:r})=>{const[m,u]=a.useState("CI"),[c,h]=a.useState("NATURAL"),[j,s]=a.useState(""),[n,v]=a.useState(""),[b,f]=a.useState(""),[g,_]=a.useState(""),[w,S]=a.useState(""),[N,C]=a.useState(""),[z,l]=a.useState(""),[T,$]=a.useState("activo"),[o,i]=a.useState(""),A=d=>{d.preventDefault(),D.post("/clientes",{tipo_documento:m,tipo:c,numero_documento:j,nombre_razon_social:n,direccion:g,propietario:b,ubicacion:w,telefono:N,email:z,estado:T,notas:o},{onSuccess:()=>{t(),r(`Cliente '${n}' creado correctamente ✅`)},onError:L=>{console.error(L),alert("Error al crear el cliente. Ver consola para más detalles.")}})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"p-6 rounded w-96 bg-neutral-100 dark:bg-neutral-800",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Nuevo Cliente"}),e.jsxs("form",{onSubmit:A,className:"space-y-2",children:[e.jsx("input",{type:"hidden",name:"tipo_documento",value:m}),e.jsx(k,{children:"Nombre / Razón Social"}),e.jsx(p,{type:"text",placeholder:"Nombre / Razón Social",value:n,onChange:d=>v(d.target.value),required:!0}),e.jsx(k,{children:"Propietario"}),e.jsx(p,{type:"text",placeholder:"Propietario",value:b,onChange:d=>f(d.target.value)}),e.jsx(k,{children:"Dirección"}),e.jsx(p,{type:"text",placeholder:"Dirección",value:g,onChange:d=>_(d.target.value)}),e.jsx(k,{children:"Ubicación"}),e.jsx(p,{type:"text",placeholder:"Ubicación",value:w,onChange:d=>S(d.target.value)}),e.jsx(k,{children:"Teléfono"}),e.jsx(p,{type:"text",placeholder:"Teléfono",value:N,onChange:d=>C(d.target.value)}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-2",children:[e.jsx(x,{type:"button",onClick:t,variant:"secondary",children:"Cancelar"}),e.jsx(x,{type:"submit",variant:"default",children:"Crear"})]})]})]})})},K=({cliente:t,onClose:r,onSaved:m})=>{const[u,c]=a.useState(t.numero_documento),[h,j]=a.useState(t.nombre_razon_social),[s,n]=a.useState(t.direccion),[v,b]=a.useState(t.telefono),[f,g]=a.useState(t.email),[_,w]=a.useState(t.notas||""),[S,N]=a.useState(t.tipo_documento||"CI"),[C,z]=a.useState(t.tipo||"activo"),[l,T]=a.useState(t.estado||"activo"),$=o=>{o.preventDefault();const i=new FormData;i.append("numero_documento",u),i.append("nombre_razon_social",h),i.append("direccion",s),i.append("telefono",v),i.append("email",f),i.append("notas",_),i.append("tipo_documento",S),i.append("tipo",C),i.append("estado",l),i.append("_method","PUT"),D.post(`/clientes/${t.id}`,i,{onSuccess:()=>{m(`Cliente '${h}' actualizado correctamente ✅`),r()}})};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"p-6 rounded w-96 bg-neutral-100 dark:bg-neutral-800",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Editar Cliente"}),e.jsxs("form",{onSubmit:$,className:"space-y-2",children:[e.jsx(p,{type:"text",placeholder:"Número de documento",value:u,onChange:o=>c(o.target.value),required:!0}),e.jsxs(E,{value:S,onValueChange:o=>N(o),children:[e.jsx(I,{children:e.jsx(P,{placeholder:"Tipo de documento"})}),e.jsxs(R,{children:[e.jsx(y,{value:"CI",children:"CI"}),e.jsx(y,{value:"NIT",children:"NIT"})]})]}),e.jsx(p,{type:"text",placeholder:"Nombre o Razón Social",value:h,onChange:o=>j(o.target.value),required:!0}),e.jsx(p,{type:"text",placeholder:"Dirección",value:s,onChange:o=>n(o.target.value)}),e.jsx(p,{type:"text",placeholder:"Teléfono",value:v,onChange:o=>b(o.target.value)}),e.jsx(p,{type:"email",placeholder:"Email",value:f,onChange:o=>g(o.target.value)}),e.jsx("textarea",{placeholder:"Notas",className:"border p-2 w-full",value:_,onChange:o=>w(o.target.value)}),e.jsxs(E,{value:C,onValueChange:o=>z(o),children:[e.jsx(I,{children:e.jsx(P,{placeholder:"Tipo"})}),e.jsxs(R,{children:[e.jsx(y,{value:"activo",children:"Activo"}),e.jsx(y,{value:"inactivo",children:"Inactivo"})]})]}),e.jsxs(E,{value:l,onValueChange:o=>T(o),children:[e.jsx(I,{children:e.jsx(P,{placeholder:"Estado"})}),e.jsxs(R,{children:[e.jsx(y,{value:"activo",children:"Activo"}),e.jsx(y,{value:"inactivo",children:"Inactivo"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 mt-2",children:[e.jsx(x,{onClick:r,variant:"secondary",children:"Cancelar"}),e.jsx(x,{type:"submit",variant:"default",children:"Guardar"})]})]})]})})},O=({cliente:t,onClose:r})=>t?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[1000]",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-md w-full p-6 relative shadow-lg",children:[e.jsx("h2",{className:"text-lg font-semibold mb-2",children:"Detalle del Cliente"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:"Información completa del cliente seleccionado."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"ID:"})," ",t.id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Nombre / Razón Social:"})," ",t.nombre_razon_social]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Documento:"})," ",`${t.tipo??""} ${t.tipo_documento??""} ${t.numero_documento??""}`]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Email:"})," ",t.email||"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Teléfono:"})," ",t.telefono||"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Dirección:"})," ",t.direccion||"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Creado:"})," ",t.created_at?new Date(t.created_at).toLocaleString():"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Actualizado:"})," ",t.updated_at?new Date(t.updated_at).toLocaleString():"—"]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(x,{variant:"secondary",onClick:r,children:"Cerrar"})})]})}):null,Q=({initialSearch:t=""})=>{const[r,m]=a.useState(t),u=c=>{c.preventDefault(),D.get("/clientes",{search:r},{preserveState:!0})};return e.jsxs("form",{onSubmit:u,className:"mb-4 flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Buscar cliente...",className:"border p-2 flex-1",value:r,onChange:c=>m(c.target.value)}),e.jsx(x,{type:"submit",variant:"default",className:"px-4 py-2",children:"Buscar"})]})},he=({clientes:t,filters:r})=>{const{flash:m}=M().props,[u,c]=a.useState(m?.success||null),[h,j]=a.useState(!1),[s,n]=a.useState(null),[v,b]=a.useState(null),[f,g]=a.useState(null),[_,w]=a.useState("/api/ventas"),S=l=>{D.delete(`/clientes/${l.id}`,{onSuccess:()=>c(`Cliente '${l.nombre_razon_social}' eliminado correctamente.`)}),b(null)},N=l=>{c(l)},C=l=>{l&&D.visit(l,{preserveScroll:!0,preserveState:!0})},z=[{title:"Clientes",href:"/clientes"}];return e.jsx(U,{breadcrumbs:z,children:e.jsxs("div",{className:"p-4",children:[e.jsx(x,{onClick:()=>j(!0),variant:"default",className:"mb-4",children:"Nuevo Cliente"}),e.jsx(Q,{initialSearch:r.search}),e.jsx(H,{clientes:t,filters:r,onEdit:n,onDelete:b,onDetail:g}),e.jsx(G,{links:t?.links??[],onPageChange:C}),h&&e.jsx(J,{onClose:()=>j(!1),onSaved:l=>N(l)}),s&&e.jsx(K,{cliente:s,onClose:()=>n(null),onSaved:l=>N(l)}),f&&e.jsx(O,{cliente:f,onClose:()=>g(null)}),v&&e.jsx(B,{text:v.nombre_razon_social,onConfirm:()=>S(v),onClose:()=>b(null)}),u&&e.jsx(F,{message:u,onClose:()=>c(null)})]})})};export{he as default};
