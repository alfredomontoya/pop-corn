import{r as a,j as e,H as S}from"./app-Dirc8Dxq.js";import{A as w}from"./app-layout-73mEwPg6.js";import{u as _}from"./useVentas-YqN4aqKt.js";/* empty css            */import"./Edit-HdEDvN3P.js";import"./button-DWW02SMM.js";import"./index-DiaJ5on7.js";import"./createLucideIcon-CDbX26ET.js";import"./index-DpVR0uHb.js";import"./index-DQr8XXov.js";import"./index-CoZuJPrS.js";import"./app-logo-icon-CzPGUPWN.js";function k({venta:s,clientes:r,tiposPago:n,productos:u,onSubmit:d}){const[c,h]=a.useState(s?.tipo_pago_id??n[0]?.id),[m,b]=a.useState(""),[l,f]=a.useState(r.find(t=>t.id===s?.cliente_id)??null),[o,j]=a.useState(s?.total??0),[i,g]=a.useState(s?.efectivo??0),[p,N]=a.useState(s?.cambio??0),[v,E]=a.useState(s?.estado??"pendiente"),[y,V]=a.useState(s?.detalles??[]);a.useEffect(()=>{N(Math.max(0,i-o))},[o,i]);const x=r.filter(t=>t.nombre_razon_social.toLowerCase().includes(m.toLowerCase())),C=t=>{if(t.preventDefault(),!l)return alert("Debe seleccionar un cliente");if(i<o)return alert("El efectivo no puede ser menor al total");d({cliente_id:l.id,tipo_pago_id:c,total:o,efectivo:i,cambio:p,estado:v,detalles:y})};return e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-2",children:"Tipo de Pago"}),e.jsx("div",{className:"flex gap-4",children:n.map(t=>e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",value:t.id,checked:c===t.id,onChange:()=>h(t.id)}),t.nombre]},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-2",children:"Cliente"}),e.jsx("input",{type:"text",value:m,onChange:t=>b(t.target.value),placeholder:"Buscar cliente...",className:"border rounded p-2 w-full"}),m&&e.jsxs("ul",{className:"border rounded mt-2 max-h-40 overflow-y-auto bg-white shadow",children:[x.map(t=>e.jsx("li",{onClick:()=>{f(t),b("")},className:"p-2 hover:bg-gray-100 cursor-pointer",children:t.nombre_razon_social},t.id)),x.length===0&&e.jsx("li",{className:"p-2 text-gray-500",children:"No se encontraron clientes"})]}),l&&e.jsxs("p",{className:"text-sm text-green-600 mt-1",children:["Cliente seleccionado: ",e.jsxs("strong",{children:[l.nombre_razon_social,", ",l.direccion," "]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-2",children:"Total"}),e.jsx("input",{type:"number",value:o,onChange:t=>j(Number(t.target.value)),className:"border rounded p-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-2",children:"Efectivo"}),e.jsx("input",{type:"number",value:i,onChange:t=>g(Number(t.target.value)),className:"border rounded p-2 w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block font-semibold mb-2",children:"Cambio"}),e.jsx("input",{type:"number",value:p,readOnly:!0,className:"border rounded p-2 w-full bg-gray-100"})]}),e.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Guardar Venta"})]})}function M({clientes:s,tiposPago:r,productos:n}){const{saveVenta:u}=_(""),d=c=>{u(c)};return e.jsxs(w,{children:[e.jsx(S,{title:"Nueva Venta"}),e.jsx("div",{className:"py-6",children:e.jsx("div",{className:"max-w-6xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white shadow rounded-lg p-6",children:e.jsx(k,{clientes:s,tiposPago:r,productos:n,onSubmit:d})})})})]})}export{M as default};
