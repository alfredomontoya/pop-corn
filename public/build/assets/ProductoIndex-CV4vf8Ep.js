import{j as e,a as p,r as c,c as k,L as w}from"./app-BptPjD3z.js";import{A as S}from"./app-layout-CmfWQkF8.js";import{P as C}from"./PaginationInertia-Dd9LaiSF.js";import{B as x}from"./button-YlEUOrkT.js";import{a as P,C as D}from"./chevron-up-BckAPb2f.js";import{Z as _}from"./ZoomImageModal-BXjQHd3B.js";import{X as E}from"./index-CKqZ0YDH.js";import{C as I}from"./ConfirmModal-DRK04dIl.js";import{T as $}from"./Toast-CsIXEVCS.js";import{F as z}from"./FloatingCreateButton-BeVrJ15S.js";/* empty css            */import"./Edit-DSh88ZNs.js";import"./index-CX3o33-i.js";import"./index-CQYQARK0.js";import"./createLucideIcon-B3T4r_g0.js";import"./index-B1quYXf_.js";import"./app-logo-icon-BGFTalqf.js";const B=({productos:s,filters:t,onEdit:d,onDelete:l,onDetail:o,onSelect:m})=>{const r=a=>{const n=t.sort===a&&t.direction==="asc"?"desc":"asc";p.get("/productos",{sort:a,direction:n},{preserveState:!0})},i=a=>t.sort!==a?null:t.direction==="asc"?e.jsx(P,{className:"inline-block w-4 h-4 ml-1"}):e.jsx(D,{className:"inline-block w-4 h-4 ml-1"});return e.jsxs("div",{className:"overflow-x-auto bg-default rounded-lg shadow",children:[e.jsxs("table",{className:"min-w-full text-sm text-left border",children:[e.jsx("thead",{className:"bg-default",children:e.jsxs("tr",{children:[e.jsxs("th",{className:"px-4 py-2 border cursor-pointer",onClick:()=>r("id"),children:["ID ",i("id")]}),e.jsx("th",{className:"px-4 py-2 border",children:"Imagen"}),e.jsx("th",{className:"px-4 py-2 border cursor-pointer",children:"Categoria"}),e.jsxs("th",{className:"px-4 py-2 border cursor-pointer",onClick:()=>r("nombre"),children:["Nombre ",i("nombre")]}),e.jsxs("th",{className:"px-4 py-2 border cursor-pointer",onClick:()=>r("precio"),children:["Precio ",i("precio")]}),e.jsxs("th",{className:"px-4 py-2 border cursor-pointer",onClick:()=>r("stock"),children:["Stock ",i("stock")]}),e.jsx("th",{className:"px-4 py-2 border",children:"Acciones"})]})}),e.jsx("tbody",{children:s?.data?.length?s.data.map(a=>e.jsxs("tr",{className:"border-t hover:bg-neutral-100 dark:hover:bg-neutral-800 cursor-pointer",onClick:()=>o(a),children:[e.jsx("td",{className:"px-4 py-2",children:a.id}),e.jsx("td",{className:"px-4 py-2",children:a.imagen_principal?e.jsx("img",{src:a.imagen_principal.imagen?.startsWith("http")?a.imagen_principal.imagen:`/storage/${a.imagen_principal.imagen}`,alt:a.nombre,className:"w-12 h-12 object-cover rounded",loading:"lazy"}):e.jsx("img",{src:"/images/default-product.png",alt:a.nombre,className:"w-12 h-12 object-cover rounded",loading:"lazy"})}),e.jsx("td",{className:"px-4 py-2",children:a.categoria?.nombre}),e.jsx("td",{className:"px-4 py-2",children:a.nombre}),e.jsxs("td",{className:"px-4 py-2",children:["Bs. ",a.precio_activo?.precio_venta]}),e.jsx("td",{className:"px-4 py-2",children:a.stock_actual}),e.jsxs("td",{className:"px-4 py-2 space-x-2",children:[e.jsx(x,{onClick:n=>{n.stopPropagation(),p.visit(`/productos/${a.id}`)},variant:"warning",className:"px-2 py-1",children:"Detalle"}),e.jsx(x,{onClick:n=>{n.stopPropagation(),p.get(`/productos/${a.id}/edit`)},variant:"warning",className:"px-2 py-1",children:"Editar"}),e.jsx(x,{onClick:n=>{n.stopPropagation(),m(a)},variant:"warning",className:"px-2 py-1",children:"Imagenes"}),e.jsx(x,{onClick:n=>{n.stopPropagation(),l(a)},variant:"destructive",className:"px-2 py-1",children:"Eliminar"})]})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-2 text-center text-gray-500",children:"No hay productos disponibles"})})})]}),e.jsx(C,{links:s?.links??[]})]})},N=s=>s?new Date(s).toLocaleDateString():"—",L=({producto:s,onClose:t})=>{const[d,l]=c.useState(!1),[o,m]=c.useState("");if(!s)return null;c.useEffect(()=>{const i=a=>{a.key==="Escape"&&t()};return window.addEventListener("keydown",i),()=>window.removeEventListener("keydown",i)},[t]);const r=s.imagenes?.find(i=>i.es_principal);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[1000]",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg max-w-2xl w-full max-h-[90vh] p-6 relative shadow-lg overflow-y-auto",children:[e.jsx("button",{onClick:t,className:"absolute top-3 right-3 bg-gray-200 dark:bg-gray-700 rounded-full p-1.5 shadow hover:bg-gray-300 dark:hover:bg-gray-600 transition",children:e.jsx(E,{size:18,className:"text-gray-700 dark:text-gray-200"})}),r&&e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:r.imagen.startsWith("http")?r.imagen:`/storage/${r.imagen}`,alt:s.nombre,className:"w-56 h-56 object-cover rounded-lg border-4 border-blue-500 shadow-md cursor-pointer hover:opacity-90 transition",onClick:()=>{m(r.imagen.startsWith("http")?r.imagen:`/storage/${r.imagen}`),l(!0)}})}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Detalle del Producto"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-4",children:"Información Resumida del producto seleccionado."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"ID:"})," ",s.id]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Nombre:"})," ",s.nombre]}),s.descripcion&&e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Descripción:"})," ",s.descripcion]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Categoría:"})," ",s.categoria?.nombre??"—"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Precio actual:"})," ",s.precio_activo?.precio_venta??"—"," ",e.jsxs("span",{className:"ml-2 text-xs px-2 py-0.5 rounded bg-gray-200 dark:bg-gray-700",children:["Activo: ",s.precio_activo?.activo?"Sí":"No"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Creado:"})," ",N(s.created_at)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:"Actualizado:"})," ",N(s.updated_at)]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx(x,{variant:"secondary",onClick:t,children:"Cerrar"})})]})}),e.jsx(_,{open:d,onOpenChange:l,src:o,alt:s.nombre})]})},A=({initialSearch:s=""})=>{const[t,d]=c.useState(s),l=o=>{o.preventDefault(),p.get("/productos",{search:t},{preserveState:!0})};return e.jsxs("form",{onSubmit:l,className:"mb-4 flex space-x-2",children:[e.jsx("input",{type:"text",placeholder:"Buscar producto...",className:"border p-2 flex-1",value:t,onChange:o=>d(o.target.value)}),e.jsx(x,{type:"submit",variant:"default",className:"px-4 py-2",children:"Buscar"})]})},se=({productos:s,categorias:t,filters:d})=>{const{flash:l}=k().props,[o,m]=c.useState(l?.success||null),[r,i]=c.useState(!1),[a,n]=c.useState(null),[u,g]=c.useState(null),[j,b]=c.useState(null),[M,f]=c.useState(s.data[0]),v=h=>{p.delete(`/productos/${h.id}`,{onSuccess:()=>m(`Producto '${h.nombre}' eliminado correctamente.`)}),g(null)},y=[{title:"Productos",href:"/productos"}];return e.jsx(S,{breadcrumbs:y,children:e.jsxs("div",{className:"p-4",children:[e.jsx(z,{}),e.jsx(w,{href:"/productos/create",className:"mb-4 bg-black text-white px-4 py-2 rounded hover:bg-black/50 decoration-none inline-block",children:"Nuevo Producto"}),e.jsx(A,{initialSearch:d.search}),e.jsx(B,{productos:s,filters:d,onEdit:n,onDelete:g,onDetail:b,onSelect:h=>{f(h)}}),j&&e.jsx(L,{producto:j,onClose:()=>b(null)}),u&&e.jsx(I,{text:u.nombre,onConfirm:()=>v(u),onClose:()=>g(null)}),o&&e.jsx($,{message:o,onClose:()=>m(null)})]})})};export{se as default};
